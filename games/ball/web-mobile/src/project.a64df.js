window.__require=function e(c,t,o){function i(n,a){if(!t[n]){if(!c[n]){var s=n.split("/");if(s=s[s.length-1],!c[s]){var l="function"==typeof __require&&__require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+n+"'")}n=s}var u=t[n]={exports:{}};c[n][0].call(u.exports,function(e){return i(c[n][1][e]||e)},u,u.exports,e,c,t,o)}return t[n].exports}for(var r="function"==typeof __require&&__require,n=0;n<o.length;n++)i(o[n]);return i}({contact:[function(e,c,t){"use strict";cc._RF.push(c,"0a2b5yTeKpENZLCJUiZf6rW","contact"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){},onDestroy:function(){},onBeginContact:function(e,c,t){0==c.tag&&0==t.tag&&(cc.log("onBeginContact..."),this.gameOver())},onEndContact:function(e,c,t){},onPreSolve:function(e,c,t){},onPostSolve:function(e,c,t){},gameOver:function(){this.callBack&&this.callBack()},gameOverCallBack:function(e){this.callBack=e},hideBall:function(){this.node.runAction(cc.fadeOut(1))},showBall:function(){this.node.opacity=0,this.node.runAction(cc.fadeIn(.5))}}),cc._RF.pop()},{}],gameLayer:[function(e,c,t){"use strict";cc._RF.push(c,"91714l+/f9HtrTPLj+LGafE","gameLayer");var o=[198,150,98,98,98,98,98],i=[498,450,398,350,350,300,300],r=[1,1.5,2,2.5,3,4,5],n=[cc.Color.GREEN,cc.Color.CYAN,cc.Color.YELLOW,cc.Color.ORANGE,cc.Color.MAGENTA,cc.Color.RED,cc.Color.GRAY],a="sound/background",s="sound/buzz",l="sound/get_item",u="sound/pass";cc.Class({extends:cc.Component,properties:{bg:cc.Node,gameBgImg:cc.Node,physicsLayer:cc.Node,boardLayer:cc.Node,upgradeImg:cc.Node,gameScoreText:cc.Label,fireEffect0:cc.Node,fireEffect1:cc.Node,fireBody0:cc.Node,fireBody1:cc.Node,bgSp:cc.Node,gameOverLayer:cc.Node,scoreTxt:cc.Node,bestScoreTxt:cc.Node,bestScoreImg:cc.Node,newRecordImg:cc.Node,ballAtlas:cc.SpriteAtlas,ballPrefab:cc.Prefab,boardPrefab:cc.Prefab},onLoad:function(){this.allBoards=[],this.curLevel=0,this.curColorIdx=0,this.curTimeStamp=(new Date).getTime(),this.curScore=0,this.isGameOver=!1,this.playMusic(a),this.openDeviceMotion(),cc.director.getPhysicsManager().enabled=!0,cc.director.getPhysicsManager().gravity=cc.v2(0,-1e3);for(var e=0;e>=-770;)this.createALineBoard(e),e-=130;this.createBall(),this.fitNode(this.bg),this.fitNode(this.gameBgImg),this.fitNode(this.bgSp);var c=this.gameBgImg.height;this.fireEffect0.position=cc.v2(0,-c/2),this.fireEffect1.position=cc.v2(0,c/2),this.fireBody0.position=cc.v2(0,-c/2),this.fireBody1.position=cc.v2(0,c/2)},createBall:function(){var e=this;null==this.ballImg&&(this.ballImg=cc.instantiate(this.ballPrefab),this.ballImg.parent=this.physicsLayer),this.ballImg.position=cc.v2(200,300);var c=this.ballImg.getComponent("contact");c.gameOverCallBack(function(){e.isGameOver||(cc.log("game over...gameLayer"),e.playSound(s),e.isGameOver=!0,e.closeDeviceMotion(),c.hideBall(),e.gameBgImg.runAction(cc.sequence(cc.delayTime(.5),cc.callFunc(function(){e.showGameOverLayer()}))))}),c.showBall();var t=Math.floor(9*Math.random())+1;c.getComponent(cc.Sprite).spriteFrame=this.ballAtlas.getSpriteFrame("ball_"+t)},fitNode:function(e){var c=cc.view.getCanvasSize(),t=c.width/c.height;e.height=.5625/t*1280},onDestroy:function(){this.closeDeviceMotion()},openDeviceMotion:function(){cc.systemEvent.setAccelerometerEnabled(!0),cc.systemEvent.on(cc.SystemEvent.EventType.DEVICEMOTION,this.onDeviceMotionEvent,this)},closeDeviceMotion:function(){cc.systemEvent.off(cc.SystemEvent.EventType.DEVICEMOTION,this.onDeviceMotionEvent,this)},onDeviceMotionEvent:function(e){this.ballImg&&this.ballImg.getComponent(cc.RigidBody).applyForceToCenter(cc.v2(4e5*e.acc.x,0))},createALineBoard:function(e){for(var c=!0,t=[];c;){var r=Math.random()*(i[this.curLevel]-o[this.curLevel])+o[this.curLevel],n=0;if(0==t.length){var a=-360-r/2,s=r/2-360;n=Math.random()*(s-a)+a;var l={};l.w=r,l.x=n,t.push(l),this.createBoard(cc.v2(n,e),l.w)}else{var u=t[t.length-1],h=40*Math.random()+30,g=360-(n=u.w/2+r/2+h+u.x)-r/2;if(g<30&&g>0)c=!0;else{var d={};d.w=r,d.x=n,t.push(d),this.createBoard(cc.v2(d.x,e),d.w),c=g>70}}}return t},createBoard:function(e,c){var t=cc.instantiate(this.boardPrefab);t.parent=this.boardLayer,t.position=e,t.width=c,t.color=n[this.curColorIdx];for(var o=t.getComponent(cc.PhysicsPolygonCollider),i=o.points,r=0;r<i.length;r++){var a=i[r];a.x>0?t.getComponent(cc.PhysicsPolygonCollider).points[r]=cc.v2(a.x+(c-98)/2,a.y):t.getComponent(cc.PhysicsPolygonCollider).points[r]=cc.v2(a.x-(c-98)/2,a.y)}return o.apply(),this.allBoards.push(t),t},moveBoard:function(){for(var e=0;e<this.allBoards.length;e++){var c=this.allBoards[e],t=c.position.y;c.position=cc.v2(c.position.x,t+r[this.curLevel]),c.position.y>790&&(this.allBoards.splice(e,1),c.removeFromParent())}},computeGRB:function(e,c,t){return t!=c&&(c>e?(t+=8)>c&&(t=c):(t-=8)<c&&(t=c)),t},computeUpgrade:function(){var e=this,c=(new Date).getTime();c-this.curTimeStamp>=1e4&&function(){e.curLevel<6&&(e.upgradeImg.active=!0,e.upgradeImg.opacity=255,e.upgradeImg.runAction(cc.sequence(cc.delayTime(1),cc.blink(1,5),cc.fadeOut(1,0))),e.curLevel+=1),e.curTimeStamp=c;var t=n[e.curColorIdx],o=t.getR(),i=t.getG(),r=t.getB();e.curColorIdx=(e.curColorIdx+1)%7;for(var a=[],s=0;s<32;s++)a.push(cc.callFunc(function(){o=e.computeGRB(t.getR(),n[e.curColorIdx].getR(),o),i=e.computeGRB(t.getG(),n[e.curColorIdx].getG(),i),r=e.computeGRB(t.getB(),n[e.curColorIdx].getB(),r);for(var c=0;c<e.allBoards.length;c++){e.allBoards[c].color=cc.color(o,i,r,255)}})),a.push(cc.delayTime(.05));e.physicsLayer.runAction(cc.sequence(a))}()},computeSocre:function(){this.gameScoreText.string=this.curScore},showGameOverLayer:function(){this.playSound(u),this.gameOverLayer.active=!0,this.gameOverLayer.position=cc.v2(0,2e3),this.gameOverLayer.runAction(cc.moveTo(.8,cc.v2(0,0))),this.scoreTxt.getComponent(cc.Label).string=this.curScore;var e=parseInt(cc.sys.localStorage.getItem("ballBestScore")||0);this.bestScoreTxt.getComponent(cc.Label).string=e,e>=this.curScore?(this.bestScoreTxt.active=!0,this.bestScoreImg.active=!0,this.newRecordImg.active=!1):(this.bestScoreTxt.active=!1,this.bestScoreImg.active=!1,this.newRecordImg.active=!0,cc.sys.localStorage.setItem("ballBestScore",this.curScore))},againBtnCallBack:function(){var e=this;this.boardLayer.removeAllChildren(),this.gameOverLayer.runAction(cc.sequence(cc.moveTo(.3,cc.v2(1500,0)),cc.callFunc(function(){e.curScore=0,e.computeSocre(),e.isGameOver=!1,e.curLevel=0,e.curTimeStamp=(new Date).getTime(),e.curColorIdx=0,e.createBall();for(var c=0;c>=-770;)e.createALineBoard(c),c-=130;e.openDeviceMotion()})))},playMusic:function(e){cc.loader.loadRes(e,cc.AudioClip,function(e,c){cc.audioEngine.playEffect(c,!0)})},playSound:function(e){cc.loader.loadRes(e,cc.AudioClip,function(e,c){cc.audioEngine.playEffect(c,!1)})},update:function(e){if(!this.isGameOver){this.computeUpgrade(),this.moveBoard();var c=this.allBoards.length;if(c>0&&this.allBoards[c-1]){var t=this.allBoards[c-1].position;t.y>=-640&&(this.createALineBoard(t.y-130),this.curScore+=1,this.computeSocre(),this.playSound(l))}}}}),cc._RF.pop()},{}],"use_v2.1-2.2.1_cc.Toggle_event":[function(e,c,t){"use strict";cc._RF.push(c,"9eb5d0chv9N3KJguFFkCEn3","use_v2.1-2.2.1_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_isChecked=!0),cc._RF.pop()},{}]},{},["contact","gameLayer","use_v2.1-2.2.1_cc.Toggle_event"]);