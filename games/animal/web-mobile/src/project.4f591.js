window.__require=function e(t,i,n){function s(a,r){if(!i[a]){if(!t[a]){var o=a.split("/");if(o=o[o.length-1],!t[o]){var h="function"==typeof __require&&__require;if(!r&&h)return h(o,!0);if(c)return c(o,!0);throw new Error("Cannot find module '"+a+"'")}a=o}var u=i[a]={exports:{}};t[a][0].call(u.exports,function(e){return s(t[a][1][e]||e)},u,u.exports,e,t,i,n)}return i[a].exports}for(var c="function"==typeof __require&&__require,a=0;a<n.length;a++)s(n[a]);return s}({aniItem:[function(e,t,i){"use strict";cc._RF.push(t,"dd115vImI5JFo/s1A6dl6Eb","aniItem");var n=-1;cc.Class({extends:cc.Component,properties:{bgSp:cc.Node,aniSp:cc.Node,lineSp:{default:[],type:cc.Node}},onLoad:function(){},setImgAtlas:function(e){this.imgAtlas=e;for(var t=0;t<4;t++)this.lineSp[t].getComponent(cc.Sprite).spriteFrame=this.imgAtlas.getSpriteFrame("line"),this.lineSp[t].active=!1},setAniType:function(e){this._aniType=e,this.aniSp.getComponent(cc.Sprite).spriteFrame=this.imgAtlas.getSpriteFrame("a"+e)},getAniType:function(){return this._aniType},setAniBg:function(){this._isSelected?this.bgSp.getComponent(cc.Sprite).spriteFrame=this.imgAtlas.getSpriteFrame("a"):this.bgSp.getComponent(cc.Sprite).spriteFrame=this.imgAtlas.getSpriteFrame("b")},setSelected:function(e){this._isSelected=e},getSelected:function(){return this._isSelected},showLine:function(e){if(e==n)for(var t=0;t<4;t++)this.lineSp[t].active=!1;else this.lineSp[e].active=!0,this.lineSp[e].zIndex=5},setAnimalOpacity:function(e){this.aniSp.opacity=e?255:0},animalAni:function(){this.setAnimalOpacity(!1),this.aniSp.runAction(cc.fadeIn(.3))},getBg:function(){return this.bgSp}}),cc._RF.pop()},{}],gameLayer:[function(e,t,i){"use strict";cc._RF.push(t,"ca7fd9Sdy9EzqZKrym7mrGj","gameLayer");var n=-1,s=0,c=1,a=2,r=3,o="sound/click",h="sound/combo1",u="sound/combo2",l="sound/combo3",p="sound/combo4",d="sound/over",g="sound/pass",m="sound/readyGo";cc.Class({extends:cc.Component,properties:{menuBg:cc.Node,startBtn:cc.Node,gameBg:cc.Node,levelText:cc.Label,scoreText:cc.Label,bestScoreText:cc.Label,restTimesText:cc.Label,aniParentLayer:cc.Node,aniBtn:{default:[],type:cc.Button},tiziSp:cc.Node,refreshBtn:cc.Node,readySp:cc.Node,goSp:cc.Node,tipText:cc.Node,failLayer:cc.Node,winLayer:cc.Node,awardText:cc.Label,endLayer:cc.Node,endScoreText:cc.Label,againBtn:cc.Node,exitBtn:cc.Node,aniPrefab:cc.Prefab,btnImgAtlas:cc.SpriteAtlas,aniImgAtlas:cc.SpriteAtlas},onLoad:function(){this.levelText.string="1",this.scoreText.string="0";var e=parseInt(cc.sys.localStorage.getItem("aniBestScore"))||0;this.bestScoreText.string=e,this.restTimesText.string="35",this.fitNode()},fitNode:function(){var e=cc.view.getCanvasSize(),t=e.width/e.height,i=t<1280/720,n=function(e){i?(e.width=1280,e.height=1280/t):(e.width=720*t,e.height=720)},s=function(e){e.x=i?e.position.x:e.position.x+(720*t-1280)/2},c=function(e){e.y=i?e.position.y+(1280/t-720)/2:e.position.y},a=function(e){e.y=i?e.position.y-(1280/t-720)/2:e.position.y};n(this.menuBg),n(this.gameBg),n(this.endLayer),function(e){e.x=i?e.position.x:e.position.x-(720*t-1280)/2}(this.refreshBtn),s(this.tiziSp),s(this.tipText),c(this.refreshBtn),c(this.tiziSp),a(this.startBtn),a(this.againBtn),a(this.exitBtn),a(this.tipText),function(e){var t=cc.view.getCanvasSize().height/720;e.height=700*t,e.width=700*t}(this.aniParentLayer)},showGameLayer:function(){this.gameBg.active=!0,this.readyGoAni(),this.changeBgSp(),this.resetGame()},readyGoAni:function(){var e=this;this.playSound(m,!1),this.readySp.active=!0,this.readySp.opacity=0,this.readySp.runAction(cc.sequence(cc.fadeIn(.2),cc.delayTime(.5),cc.fadeOut(.3))),this.goSp.active=!0,this.goSp.opacity=0,this.goSp.runAction(cc.sequence(cc.delayTime(1),cc.fadeIn(.2),cc.delayTime(.5),cc.fadeOut(.3),cc.callFunc(function(){for(var t=0;t<6;t++)e.aniBtn[t].enabled=!0})))},changeBgSp:function(){var e="bg/bg"+Math.floor(100*Math.random())%5;cc.loader.loadRes(e,cc.SpriteFrame,function(e,t){e?cc.error(e.message||e):this.gameBg.getComponent(cc.Sprite).spriteFrame=t}.bind(this))},createAnis:function(){var e=this;this._curAniTypes=[],this._allAnimals=[];for(var t=0;t<6;){for(var i=Math.floor(100*Math.random())%14,n=!0,s=0;s<this._curAniTypes.length;s++){this._curAniTypes[s]==i&&(n=!1)}n&&(this._curAniTypes.push(i),t++)}for(var c=0;c<14;c++)for(var a=function(t){var i=cc.instantiate(e.aniPrefab);i.parent=e.aniParentLayer,i.position=cc.v2(50*t+25-350,350-(50*c+25));var n=i.getComponent("aniItem");n.setImgAtlas(e.aniImgAtlas),n.setAnimalOpacity(!1);var s=Math.floor(100*Math.random())%6;n.setAniType(e._curAniTypes[s]),n.setSelected(!1),n.setAniBg(),n.getBg().runAction(cc.sequence(cc.delayTime(.007*(14*c+t)),cc.callFunc(function(){n.animalAni()}))),e._allAnimals.push(n)},r=0;r<14;r++)a(r);for(var o=0;o<6;o++){this._curAniTypes[o];this.aniBtn[o].getComponent(cc.Sprite).spriteFrame=this.aniImgAtlas.getSpriteFrame("a"+this._curAniTypes[o]),this.aniBtn[o].node.attr({_tag_:this._curAniTypes[o]})}},computeAnis:function(){for(var e=0;e<13;e++)for(var t=0;t<14;t++)for(var i=0;i<14;i++){var n=14*t+i,s=this._allAnimals[n],c=s.getSelected();if(s.getAniType()==this._newType&&0==c)for(var a=t-1;a<=t+1;a++)for(var r=i-1;r<=i+1;r++){var o=!0;if((a<0||a>=14||r<0||r>=14)&&(o=!1),(a!=t&&r!=i||a==t&&r==i)&&(o=!1),o){var h=14*a+r;this._allAnimals[h].getSelected()&&(s.setSelected(!0),s.setAniBg())}}}},showRedLine:function(){this._curNum=0;for(var e=0;e<14;e++)for(var t=0;t<14;t++){var i=14*e+t,o=this._allAnimals[i],h=o.getSelected();if(o.showLine(n),h){this._curNum=this._curNum+1;for(var u=e-1;u<=e+1;u++)for(var l=t-1;l<=t+1;l++){var p=!0;if((u<0||u>=14||l<0||l>=14)&&(-1==u?o.showLine(s):14==u?o.showLine(c):-1==l?o.showLine(a):14==l&&o.showLine(r),p=!1),(u!=e&&l!=t||u==e&&l==t)&&(p=!1),p){var d=14*u+l;this._allAnimals[d].getSelected()||(u<e?o.showLine(s):u>e?o.showLine(c):l<t?o.showLine(a):l>t&&o.showLine(r))}}}}},computeScore:function(){var e=0,t=this._curNum-this._lastNum;return t<=2?e=10*t:t<=5?(e=10*t*2,this.playSound(h,!1)):t<=10?(e=10*t*3,this.playSound(u,!1)):t<=15?(e=10*t*4,this.playSound(l,!1)):(e=10*t*4,this.playSound(p,!1)),e},checkOver:function(){196==this._curNum?this.gameWinLayer():0==this._restTimes&&this.gameFailLayer()},gameWinLayer:function(){this.winLayer.active=!0,this.playSound(g,!1);var e=100*this._restTimes;this.awardText.getComponent(cc.Label).string=e>0?"\u5956\u52b1\uff1a"+e:"",this._curScore=this._curScore+e,this.updateScore(),this.saveHighScore()},gameFailLayer:function(){this.failLayer.active=!0,this.playSound(d,!1)},updateLevel:function(){this.levelText.string=this._curLevel},updateScore:function(){this.scoreText.string=this._curScore},saveHighScore:function(){var e=parseInt(cc.sys.localStorage.getItem("AnimalGameHighScore")||0);this._curScore>e&&(cc.sys.localStorage.setItem("AnimalGameHighScore",this._curScore),this.bestScoreText.string=this._curScore)},updateRestTimes:function(){this.restTimesText.string=this._restTimes},showEndLayer:function(){this.endLayer.active=!0,this.endScoreText.string="\u5f97\u5206\uff1a"+this._curScore},nextGame:function(){this.changeBgSp(),this.endLayer.active=!1,this.aniParentLayer.removeAllChildren(),this._lastNum=0,this._curNum=0,this._curLevel=this._curLevel+1,this.updateLevel(),this._restTimes=36-this._curLevel,this.updateRestTimes();for(var e=0;e<6;e++)this.aniBtn[e].enabled=!1;this.readyGoAni(),this.createAnis();var t=this._allAnimals[0];t.setSelected(!0),t.setAniBg(),this._lastType=t.getAniType(),this._newType=this._lastType,this.computeAnis(),this.showRedLine(),this._lastNum=this._curNum},resetGame:function(){this._curLevel=0,this._lastType=0,this._newType=0,this._curScore=0,this.updateScore(),this.saveHighScore(),this.nextGame()},startBtnCallBack:function(e,t){this.playSound(o,!1),this.showGameLayer()},aniBtnCallBack:function(e,t){if(this.playSound(o,!1),this._newType=e.target._tag_,this._lastType!=this._newType){for(var i=0;i<14;i++)for(var n=0;n<14;n++){var s=14*i+n,c=this._allAnimals[s];c.getSelected()&&(c.setAniType(this._newType),c.setAniBg())}this.computeAnis(),this.showRedLine(),this._restTimes=this._restTimes-1,this.updateRestTimes(),this._lastType=this._newType;var a=this.computeScore();this._curScore=this._curScore+a,this.updateScore(),this.saveHighScore(),this._lastNum=this._curNum,this.checkOver()}},resetBtnCallBack:function(e,t){this.playSound(o,!1),this.resetGame()},nextBtnCallBack:function(e,t){this.playSound(o,!1),this.winLayer.active=!1,this.nextGame()},overBtnCallBack:function(e,t){this.playSound(o,!1),this.failLayer.active=!1,this.showEndLayer()},againBtnCallBack:function(e,t){this.playSound(o,!1),this.resetGame()},exitBtnCallBack:function(e,t){this.playSound(o,!1),this.endLayer.active=!1,this.gameBg.active=!1},playSound:function(e,t){cc.loader.loadRes(e,cc.AudioClip,function(e,i){if(!e)cc.audioEngine.playEffect(i,t)})},update:function(e){}}),cc._RF.pop()},{}],"use_v2.1-2.2.1_cc.Toggle_event":[function(e,t,i){"use strict";cc._RF.push(t,"55739NvFVhBGIU22yfBmz5j","use_v2.1-2.2.1_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_isChecked=!0),cc._RF.pop()},{}]},{},["aniItem","gameLayer","use_v2.1-2.2.1_cc.Toggle_event"]);